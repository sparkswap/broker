syntax = "proto3";

import "google/protobuf/empty.proto";

enum Side {
  BID = 0;
  ASK = 1;
}

enum TimeInForce {
  GTC = 0;
  FOK = 1;
  IOC = 2;
}

message Price {
  uint64 integer = 0;
  uint64 decimal = 1;
}

message CreateBlockOrderRequest {
  string market = 0;
  Side side = 1;
  int64 amount = 2;
  oneof price_restriction {
    bool is_market_order = 3;
    Price limit_price = 4;
  }

  TimeInForce time_in_force = 5 [default = GTC];
}

message CreateBlockOrderResponse {
  string block_order_id = 0;
}

enum BlockOrderStatus {
  ACTIVE = 0;
  CANCELLED = 1;
  COMPLETED = 2;
  FAILED = 3;
}

enum OrderStatus {
  CREATED = 0;
  PLACED = 1;
  FILLED = 2;
  EXECUTED = 3;
  COMPLETED = 4;
  REJECTED = 5;
}

message Order {
  string order_id = 0;
  OrderStatus order_status = 1;
  int64 amount = 2;
  Price price = 3;
}

enum FillStatus {
  CREATED = 0;
  FILLED = 1;
  EXECUTED = 2;
  COMPLETED = 3;
  REJECTED = 4;
}

message Fill {
  string order_id = 0;
  string fill_id = 1;
  FillStatus fill_status = 2;
  int64 amount = 3;
  Price price = 4;
}

message GetBlockOrderRequest {
  string block_order_id = 0;
}

message GetBlockOrderResponse {
  BlockOrderStatus status = 0;

  string market = 10;
  Side side = 11;
  int64 amount = 12;
  oneof price_restriction {
    bool is_market_order = 13;
    Price limit_price = 14;
  }
  TimeInForce time_in_force = 15;

  int64 fill_amount = 20;
  repeated Order open_orders = 21;
  repeated Fill fills = 22;
}

message CancelBlockOrderRequest {
  string block_order_id = 0;
}

service OrderService {
  rpc CreateBlockOrder (CreateBlockOrderRequest) returns (CreateBlockOrderResponse);
  rpc GetBlockOrder (GetBlockOrderRequest) returns (GetBlockOrderResponse);
  rpc CancelBlockOrder (CancelBlockOrderRequest) returns (google.protobuf.Empty);
}
